(this["webpackJsonpreact-battleships"]=this["webpackJsonpreact-battleships"]||[]).push([[0],{21:function(n,e,t){},27:function(n,e,t){"use strict";t.r(e);var r=t(1),i=t.n(r),o=t(13),c=t.n(o),a=(t(21),t(2)),u=t(5);function s(n){return d(n)}function d(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=function(e){return e.x<0||e.x>n-1||e.y<0||e.y>n-1},i=function(n){return e.some((function(e){return e.getBoardSpaceCoords().some((function(e){return e.equals(n)}))}))},o=function(n){return t.some((function(e){return e.equals(n)}))},c=function(n){return e.some((function(e){return e.hits.some((function(e){return e.equals(n)}))}))},a=function(){return e.reduce((function(n,e){return[].concat(Object(u.a)(n),Object(u.a)(e.hits))}),[])},s=function(n){return n.getBoardSpaceCoords().every((function(n){return!r(n)&&!i(n)}))},l=function(n){return!r(n)&&!o(n)&&!c(n)},f=function(r){if(!s(r))throw new Error("Tried to add ship at illegal board position ".concat(r.getBoardSpaceCoords().map((function(n){return"(".concat(n.x,",").concat(n.y,")")}))));return d(n,[].concat(Object(u.a)(e),[r]),t)},h=function(r){return r.reduce((function(n,e){return n.addShip(e)}),d(n,e,t))},j=function(i){if(r(i))throw new Error("Tried to receive hit at illegal position (".concat(i.x,", ").concat(i.y,")"));var o=e.find((function(n){return n.getBoardSpaceCoords().some((function(n){return n.equals(i)}))}));if(o){var c=o.getBoardSpaceCoords().findIndex((function(n){return n.equals(i)})),a=o.hit(c),s=e.map((function(n){return n===o?a:n}));return d(n,s,t)}var l=[].concat(Object(u.a)(t),[i]);return d(n,e,l)},b=function(){return e.every((function(n){return n.isSunk()}))};return{size:n,ships:e,addShip:f,addShips:h,receiveHit:j,isEveryShipSunk:b,isValidShipPos:s,isValidMovePos:l,isMissPos:o,isHitPos:c,misses:t,get hits(){return a()}}}var l,f,h,j,b=t(3),p=t(4),g=p.a.div(l||(l=Object(b.a)(["\n  grid-column: ",";\n  grid-row: ",";\n"])),(function(n){return n.pos.x+1}),(function(n){return n.pos.y+1})),O=Object(p.a)(g)(f||(f=Object(b.a)(["\n  background-color: green;\n  border-radius: 50%;\n  opacity: 50%;\n"]))),v=Object(p.a)(g)(h||(h=Object(b.a)(["\n  background-color: red;\n  border-radius: 50%;\n  opacity: 50%;\n"]))),x=t(0);function m(n){var e=n.hits,t=n.misses,r=function(n){return"(".concat(n.x,", ").concat(n.y,")")};return Object(x.jsxs)(x.Fragment,{children:[e.map((function(n){return Object(x.jsx)(O,{pos:n},r(n))})),t.map((function(n){return Object(x.jsx)(v,{pos:n},r(n))}))]})}var y=p.a.div(j||(j=Object(b.a)(["\n  /* TODO: query screen width to set cell size */\n  --container-size: 20rem;\n  --cell-size: ",";\n\n  /* box-sizing: border-box; */\n  display: grid;\n  grid-template-columns: repeat(",", var(--cell-size));\n  grid-template-rows: repeat(",", var(--cell-size));\n\n  max-width: var(--container-size);\n\n  border: 1px solid black;\n\n  > .grid-bg {\n    border: 1px solid black;\n    text-align: center;\n    cursor: pointer;\n  }\n"])),(function(n){var e=n.size;return"calc(var(--container-size)/".concat(e,")")}),(function(n){return n.size}),(function(n){return n.size})),S=t(6),C=function n(e,t){var r=function(n){return null!=n.x&&null!=n.y};return Object.freeze({x:e,y:t,equals:function(n){return n.x===e&&n.y===t},add:function(i){return r(i)?n(e+i.x,t+i.y):n(e+i,t+i)},multiply:function(i){return r(i)?n(e*i.x,t*i.y):n(e*i,t*i)}})},w=Object.freeze({up:C(0,-1),right:C(1,0),down:C(0,1),left:C(-1,0)}),k=[w.up,w.right,w.down,w.left],z=Object.freeze(Object(S.a)(Object(S.a)({},w),{},{indexed:k,increment:function(n,e){return k[(k.findIndex((function(e){return e.equals(n)}))+e)%k.length]}})),P=C;function E(n){var e=n.onCellClick,t=void 0===e?function(){}:e,r=n.onCellMouseEnter,i=void 0===r?function(){}:r,o=n.gameboard,c=n.children;return Object(x.jsxs)(y,{size:o.size,children:[function(){for(var n=[],e=0;e<o.size;e++)for(var r=function(r){var c=P(r,e);n.push(Object(x.jsxs)("div",{onClick:function(){return t(c)},onMouseEnter:function(){return i(c)},style:{gridColumn:c.x+1,gridRow:c.y+1},className:"grid-bg",children:["ABCDEFJHIJKLMNOP".split("")[r],e+1]},r+e*o.size))},c=0;c<o.size;c++)r(c);return n}(),c]})}function M(n){var e=n.gameboard,t=n.setGameboard,r=n.onAttack;return Object(x.jsx)("div",{children:Object(x.jsx)(E,{gameboard:e,onCellClick:function(n){e.isValidMovePos(n)&&(t((function(e){return e.receiveHit(n)})),r())},children:Object(x.jsx)(m,{misses:e.misses,hits:e.hits})})})}function B(n,e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Array(n).fill(!1),i=function(){return r.reduce((function(n,e,t){return e?[].concat(Object(u.a)(n),[o(t)]):n}),[])},o=function(n){return t.multiply(n).add(e)},c=function(){for(var e=[],t=0;t<n;t++)e.push(o(t));return e},a=function(i){if(i>n-1||i<0)throw new Error("Tried to hit a ship at illegal position ".concat(i));var o=Object(u.a)(r);return o[i]=!0,B(n,e,t,o)},s=function(){return!r.includes(!1)};return{length:n,origin:e,rotation:t,hit:a,isSunk:s,getBoardSpaceCoords:c,get hits(){return i()}}}var A=function(n){var e;do{e=P(Math.floor(Math.random()*n.size),Math.floor(Math.random()*n.size))}while(!n.isValidMovePos(e));return e},T=function(n,e){if(n.size<e)throw new Error("Cannot get valid ship of length ".concat(e," from board of length ").concat(n.size));var t,r=0;do{t=B(e,A(n),z.indexed[Math.floor(Math.random()*z.indexed.length)]),r++}while(!n.isValidShipPos(t)&&r<999);if(!(r>=999))return t;console.log("Could not find valid position to place ship! There are likely not enough free positions on the board")},q=function(n){for(var e=n,t=[5,4,3,3,2],r=[],i=0;i<t.length;i++){var o=T(e,t[i]);r.push(o),e=e.addShip(o)}return r};function V(n){var e=n.ship,t=n.customStyle,r=void 0===t?{background:"grey",border:"1px solid black"}:t;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{style:Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)({},r),e.isSunk()?{background:"red"}:{}),function(){var n=e.rotation.x>=0?e.origin.x+1:Math.max(1,e.origin.x-e.length+2),t=e.rotation.y>=0?e.origin.y+1:Math.max(1,e.origin.y-e.length+2),r=function(n,t){return 0===n?1:n>0?e.length:Math.min(t+1,e.length)},i=r(e.rotation.x,e.origin.x),o=r(e.rotation.y,e.origin.y);return{gridColumn:"".concat(n," / span ").concat(i),gridRow:"".concat(t," / span ").concat(o)}}()),{},{pointerEvents:"none"})}),Object(x.jsx)("div",{style:{gridColumn:e.origin.x+1,gridRow:e.origin.y+1,pointerEvents:"none",userSelect:"none"},children:"X"})]})}function N(n){var e=n.ships;return Object(x.jsx)(x.Fragment,{children:e.map((function(n){return Object(x.jsx)(V,{ship:n},"(".concat(n.origin.x,", ").concat(n.origin.y,")"))}))})}var H=function(n){var e=n.useBoardPlayer,t=n.useBoardNpc,i=n.onGameOver,o=Object(a.a)(e,2),c=o[0],u=o[1],s=Object(a.a)(t,2),d=s[0],l=s[1],f=Object(r.useState)(0),h=Object(a.a)(f,2),j=h[0],b=h[1];return Object(r.useEffect)((function(){d.isEveryShipSunk()?i("Player"):c.isEveryShipSunk()&&i("NPC")}),[c,d,i]),Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{children:["Turn: ",j]}),Object(x.jsx)("h2",{children:"NPC board"}),Object(x.jsx)(M,{gameboard:d,setGameboard:l,onAttack:function(){u((function(n){return n.receiveHit(A(n))})),b((function(n){return n+1}))}}),Object(x.jsx)("h2",{children:"Player board"}),Object(x.jsxs)(E,{gameboard:c,children:[Object(x.jsx)(m,{hits:c.hits,misses:c.misses}),Object(x.jsx)(N,{ships:c.ships})]})]})};function I(n){var e=n.ship,t=n.isValidPos;return Object(x.jsx)(V,{ship:e,customStyle:{opacity:"50%",backgroundColor:t?"green":"red"}})}function F(n){var e=n.useBoard,t=n.onAllShipsPlaced,i=[5,4,3,3,2],o=Object(r.useState)(0),c=Object(a.a)(o,2),u=c[0],s=c[1],d=Object(r.useState)(B(i[u],P(-10,-10),z.right)),l=Object(a.a)(d,2),f=l[0],h=l[1],j=Object(a.a)(e,2),b=j[0],p=j[1],g=function(n,e){return B(n.length,e,n.rotation)},O=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return B(n.length,n.origin,z.increment(n.rotation,e))},v=function(n){return e[0].isValidShipPos(n)};return Object(x.jsxs)("div",{children:[Object(x.jsx)("h2",{children:"Place your ships!"}),Object(x.jsx)("div",{onWheel:function(n){return n.deltaY>0?h((function(n){return O(n)})):h((function(n){return O(n,3)}))},children:Object(x.jsxs)(E,{gameboard:b,onCellMouseEnter:function(n){h((function(e){return g(e,n)}))},onCellClick:function(n){var e=g(f,n);v(e)?(p((function(n){return n.addShip(e)})),u<i.length-1?(h(B(i[u+1],n,e.rotation)),s((function(n){return n+1}))):t()):console.log("Oops! Can't place ship there!")},children:[Object(x.jsx)(I,{ship:f,isValidPos:v(f)}),Object(x.jsx)(N,{ships:b.ships})]})}),Object(x.jsx)("button",{onClick:function(){return h((function(n){return O(n)}))},children:"Rotate"})]})}var R="setup",G="main",J="game over";function D(){var n=Object(r.useState)((function(){return s(10)})),e=Object(r.useState)((function(){return s(10).addShips(q(s(10)))})),t=Object(r.useState)({mode:R}),i=Object(a.a)(t,2),o=i[0],c=i[1],u=function(n){c({mode:J,winner:n})},d=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("h2",{children:["Congratulations, ",o.winner,"! You won!"]}),Object(x.jsx)("button",{onClick:function(){return function(){var t=Object(a.a)(n,2)[1],r=Object(a.a)(e,2)[1];t(s(10)),r(s(10).addShips(q(s(10)))),c({mode:R})}()},children:"Play again?"})]})};return Object(x.jsxs)("div",{className:"App",style:{padding:"2rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(x.jsx)("h1",{children:"REACT-BATTLESHIP"}),function(t){switch(t){case G:return Object(x.jsx)(H,{useBoardPlayer:n,useBoardNpc:e,onGameOver:u});case R:return Object(x.jsx)(F,{useBoard:n,onAllShipsPlaced:function(){return c({mode:G})}});case J:return d();default:throw new Error("Unhandled game mode: ".concat(t,"!"))}}(o.mode)]})}c.a.render(Object(x.jsx)(i.a.StrictMode,{children:Object(x.jsx)(D,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.574bdefd.chunk.js.map